### 201903 汪开斌

基于深度学习和矩阵分解的服务质量预测方法研究.汪开斌,张以文



### 研究背景

互联网上的网络服务数量一直在快速增长。这使得用户越来越难以从大量的功能相当的候选服务中找到合适的服务。检查每个网络服务的质量值是不切实际的，因为它非常耗费资源。因此，在过去的几年里，网络服务的质量预测问题吸引了很多人的注意，重点是矩阵分解（MF）技术的应用。



### 主要问题

最近，研究人员已经开始采用用户相似性来改进基于MF的Web服务预测方法。然而，现有的方法都没有正确和系统地解决其中的两个主要问题。1）检索适当的邻域信息，即相似的用户和服务；2）利用完整的邻域信息，即用户和服务的邻域信息。



### 创新点

在本文中，我们提出了一种基于覆盖的服务质量预测方法CNMF，该方法是一种基于邻域感知矩阵分解的Web服务质量预测方法。CNMF的创新之处在于两个方面。首先，它采用了一种基于覆盖的聚类方法来寻找类似的用户和服务，这不需要预先指定聚类的数量和聚类中心。其次，它利用用户和服务的邻域信息来提高预测的准确性。在一个包含1,974,675条Web服务调用记录的真实环境数据集上进行的实验结果表明，CNMF明显优于现有的8种质量预测方法，包括两种同样利用邻域信息的最先进方法。



a) 问题定义

b) 覆盖算法

c) 邻居选择

d) 算法设计





### 相关理论

协同过滤(CF)算法是推荐系统中最重要的方法，该算法可以分为两种：基于记忆的协同过滤算法和基于模型的协同过滤算法。

* 基于记忆的协同过滤算法可以进一步的划分为基于用户的协同过滤算法，和基于项目的协同过滤算法。基于用户的CF算法通过皮尔逊相关系数计算目标用户的相似邻居，然后利用邻居集合的评分信息进行预测评分。基于项目的CF算法和基于用户的CF算法采取同样的思路，通过目标项目的相似邻居进行预测评分。

* 基于模型的协同过滤算法的经典模型主要包括：贝叶斯模型、隐语义模型和矩阵分解模型，具体的模型需要根据训练数据和机器学习方法计算得到，之后结合用户的历史数据来预测缺失值。

![image-20211021123243055](image-20211021123243055.png)

#### a) 基于用户的协同过滤算法



**算法流程：**

```markdown
1. 收集用户服务的历史Qos数据，并建立用户-服务矩阵
2. 根据用户-服务矩阵就计算相似度寻找当前用户的相似邻居集
3. 根据相似邻居集的Qos信息对缺失值进行预测
```



**计算用户相似度：**

假设用户 $u$ 和用户 $v$ 是两个不同的用户，$R_{u, i}$ 表示用户 $u$ 对服务 $i$ 的Qos值，，$R_{v, i}$ 表示用户 $v$ 对服务 $i$ 的Qos值，$I_{u,v}$ 表示用户 $u$ 和用户 $v$ 一起调用过的服务集合，$\overline{R_u}$ 表示用户 $u$ 调用过的所有服务的平均Qos值，$\overline{R_v}$ 表示用户 $v$ 调用过的所有服务的平均Qos值。

* 皮尔逊相关系数（PCC）

![image-20211021132130735](image-20211021132130735.png)

* 余弦相似度

![image-20211021132318970](image-20211021132318970.png)



**预测Qos值：**

计算出每个用户间的相似度后，使用Top-k机制选择与目标用户最相似的Top-k个用户为相似用户集合。根据具相似用户集合的Qos信息对目标用户的Qos缺失值进行预测。

![image-20211021133935229](image-20211021133935229.png)



#### b) 基于矩阵分解的协同过滤算法



**算法流程：**

```markdown
1. 收集用户服务的历史Qos数据，并建立用户-服务矩阵
2. 将高维的用户-服务矩阵分解成两个低维特征矩阵
3. 使用因子模型不断拟合用户特征矩阵和服务特征矩阵
4. 根据拟合的两个低维特征矩阵预测目标位置的缺失值
```



**矩阵分解：**

使用 $M$ 表示用户-服务矩阵， $U_{CMF} \in R_{d*m}$ 表示用户潜在特征矩阵， $I_{CMF} \in R_{d*n}$ 表示服务潜在特征矩阵。为了尝试接近 $M$，我们需要不断的拟合两个潜在特征矩阵。

![image-20211021141505495](image-20211021141505495.png)



**拟合函数：**

向量 $\overline{u}$ 表示用户潜在特征想向量，向量 $\overline{i}$ 表示服务潜在特征向量，它们的维度为 $d$ 。利用如下目标函数使 $U$ 和 $I$ 对原始矩阵 $M$ 进行近似拟合

![image-20211021142256166](image-20211021142256166.png)



其中的 Frobenius 范数，用于计算 $M$ 中的实际值与预测值之间的差值，可以将其简化如下，$F_{ui}$ 是指示符函数，如果用户 $u$ 调用过服务 $i$ ，则返回1，否则返回0。

![image-20211021143229802](image-20211021143229802.png)



为了避免过度拟合得到最优的 $U$ 和 $I$ 逼近原始矩阵 $M$，需要加入两个与 $U$ 和 $I$ 相关的正则项

![image-20211021143627624](image-20211021143627624.png)



**求最优解：**

目标函数使用二次正则项来最小化平方误差和。因为它不是凸的，所以寻找全局最小是不现实的。可以采用随机梯度下降算法求解出近似最优的潜在特征向量，其中 $\gamma_1 > 0$，$\gamma_2 > 0$ 表示学习速率。

![image-20211021144223518](image-20211021144223518.png)



 

### 评价





