## 基于 JSON 的语义 Web 服务自动组合系统的设计与实现

### 目录

1. 研究背景
2. 系统设计
3. 服务组合与匹配
4. 系统实现



### 一、研究背景

两个问题：

* Q1：XML编程语言不够轻便
* Q2：当下Web服务组合工具不够方便



改进角度：

* 利用语义技术提升Web服务组合与匹配精度
* 设计出更便于描述的业务流程设计方式
* 使用B/S架构提升系统兼容性
* 设计存储格式对服务及服务组合进行存储和检索



主要工作：

* 对 Web 服务组合与匹配的当前现状和亟待解决的问题进行了论述
* 提出了利用 JSON 对业务流程和组合 Web服务进行描述的完整方法
* 利用Kuhn-Munkres 算法实现对自然语言的相似度计算
* 设计并实现了一个组合 Web 服务 Qos 的计算方法
* 实现了用户交互界面，对Web服务和业务流程进行管理



相关技术：

|                   | 技术          | 描述                       |
| ----------------- | ------------- | -------------------------- |
| Web 服务引擎      | Apache Axis 2 | Web服务框架                |
|                   | Apache ODE    | 实现了BPEL流程的可视化开发 |
|                   | Oracle BPEL   | BPEL集成工具包             |
| 自然语言处理      | Apache Lucene | 全文检索工具包             |
|                   | WordNet       | 基于认知语言学的英语词典   |
|                   | JWI           | 对WordNet进行访问的API类库 |
| 本体与语义Web服务 | OWL           | Web本体语言                |
|                   | OWL-S         | Web服务本体语言            |

词汇表 -> 分类法 -> 本体



### 二、系统设计

系统需求：

* 使用可视化工具对Web服务进行组合，并将既定的组合转化为JSON代码编号存储，之后检索出需要的JSON代码，通过执行引擎构建组合服务。

| 角色       | 基础服务管理       | 业务流程管理                 |
| ---------- | ------------------ | ---------------------------- |
| 用户       | 服务查看           | 流程查看、组合服务执行       |
| 管理员     | 服务删除           | 流程删除                     |
| 服务提供者 | 服务添加、服务修改 | 流程添加、流程修改、流程匹配 |



系统总体框架

* Apache Server：为OWL-S文件、OWL本体文件以及WSDL文件提供了一个部署环境
* Web 服务数据库：存储基础服务管理、业务流程管理的相关信息
* 服务组合模块：根据服务描述生成服务组合图
* 服务匹配模块：根据业务流程，在服务组合图中寻找组合服务路径
* 业务流程转换模块：将服务组合路径用JSON进行描述，并存储到数据库中
* 服务执行模块：解析服务组合的JSON代码



基于 JSON 的业务流程描述

* 业务活动描述：根据input、output、description三个参数，去匹配数据库中存在的业务流程
* 业务流程描述：



数据库设计：

* 服务表
* 参数表
* 流程表
* 组合服务表
* 用户表



模块设计：

* Apache Server：为OWL-S文件、OWL本体文件以及WSDL文件提供了一个部署环境
* Web 服务数据库：存储基础服务管理、业务流程管理的相关信息
* 服务组合模块：根据服务描述生成服务组合图
* 服务匹配模块：根据业务流程，在服务组合图中寻找组合服务路径
* 业务流程转换模块：将服务组合路径用JSON进行描述，并存储到数据库中
* 服务执行模块：解析服务组合的JSON代码



### 三、服务组合与匹配

#### 1. 参数提取

从OWL-S文件中提取出输入输出参数，并存储到数据库中



#### 2. 服务组合算法

服务组合算法是指，通过将所有的Web服务作为顶点，若某顶点A的输出参数集与顶点B的输入参数集相同或相似，则添加一条从顶点A指向顶点B的边，由此建立一个有向无环图，图中的任何一条路径都可以看做是一个组合服务。

![image-20210914201114480](image-20210914201114480.png)

算法步骤：

1. 添加有向边

2. 建立服务组合图



**Q1：**

如何在顶点之间添加有向边？

**A1：**

通过比较顶点的某个输出参数，与其他顶点的某个输入参数，是否相同或相似，即计算是否存在两个参数之间相同或相似。

![image-20210915104014463](image-20210915104014463.png)



**Q2：**

如何判断相似度？

**A2：**

借助OWL本体文件和参数类型判断相似度，图中类2与类1、类3与类1相似，类2与类3之间通过最短路径距离计算语义相似度，类4与类123不相似。

![image-20210915101813741](image-20210915101813741.png)



**Q3：**

如何计算语义相似度？

**A3：**

通过结点在OWL树上的路径距离计算相似度，

![image-20210915102402409](image-20210915102402409.png)



**Q4：**

如何建立服务组合图

**A4：**

逐个顶点遍历，对顶点的所有邻接结点，执行有向边添加算法

![image-20210915105443481](image-20210915105443481.png)

![image-20210915105515375](image-20210915105515375.png)



#### 3. 服务匹配算法

服务匹配算法是指，通过用户提供的输入输出参数集，可以在服务组合图中匹配多个顶点作为组合服务路径的开始顶点和结束顶点，从而得到不定数量的连通路径，再通过组合服务的文本描述与用户提供的服务需求进行语义相似度的匹配，从中选择与业务需求最符合的组合服务。

<img src="image-20210914214146045.png" alt="image-20210914214146045" style="zoom:50%;" />



算法步骤：

1. 计算参数集相似度
2. 获取组合服务
3. 计算服务描述相似度
4. 基于语义相似度筛选服务组合



**Q1：**

如何计算单词相似度？

**A1：**

通过WordNet获取词语所在的同义词集合，然后针对两个同义词集合的关系和语义距离计算相似度。

比如：同义词集合$Set_1 = \{c_{11}, c_{12} ... c_{1m}\}$，与$Set_2 = \{c_{21}, c_{22} ... c_{2n}\}$ 的相似度，即可当做$word_1$与$word_2$的相似度



**Q2：**

如何计算同义词集合的相似度？

**A2：**

文章综合了2种经典算法

* 基于词条所属同义词集合的最小共同祖先结点，和同义词集合出现的频率计算相似度
* 基于路径长度计算相似度

![image-20210915153947713](image-20210915153947713.png)

![image-20210915153402648](image-20210915153402648.png)

![image-20210915153735441](image-20210915153735441.png)



**Q3：**

如何计算参数相似度？

**A3：**

参数通常为单词组，通过Apache Lucene进行分词处理后，两个参数的相似度可以等同于两个单词组的相似度。

比如：两个参数$param_{action}, param_{service}$的单词组分别为 $words_{action} = \{aw_1, aw_2 ... aw_m\}, words_{service} = \{sw_1, sw_2 ... sw_n\}$



首先计算两个单词组中每个单词的相似度，获取相似度矩阵$WordsSim$

![image-20210915160221840](image-20210915160221840.png)

接着为矩阵添加虚拟结点，并应用二分图匹配算法，得到参数相似度计算公式

![image-20210915160940502](image-20210915160940502.png)



**Q4：**

如何计算参数集的相似度

**A4：**

计算参数集的相似度和计算单词组相似度的方法基本一致。

假设用户提供的参数集为$ActionParams = \{aparam_1, aparam_2, ... aparam_m\}$，OWL-S 文件提供的参数集为$ServiceParams = \{sparam_1, sparam_2,... sparam_n\}$



首先计算两个参数集中每个参数的相似度，获取相似度矩阵$ParamsSim$

![image-20210915195839681](image-20210915195839681.png)

接着为矩阵添加虚拟结点，并应用二分图匹配算法，得到参数集相似度计算公式

![image-20210915200045676](image-20210915200045676.png)



**Q5：**

如何获取组合服务？

**A5：**

根据用户的输入参数集和输出参数集，对服务组合图中的所有服务进行匹配，得到开始顶点集和结束顶点集

![image-20210915202105623](image-20210915202105623.png)



接着在组合服务图中搜索连接两个顶点的有向连通路径，找出其中的最短路径

![image-20210915210459266](image-20210915210459266.png)

![image-20210915210514301](image-20210915210514301.png)

随后对开始顶点集和结束顶点集中的任意顶点应用以上算法，获得组合服务路径的集合 $ComPaths = \{cpath_1, cpath_2, ... cpath_n\}$



**Q6：**

如何计算服务描述相似度

**A6：**

本文仅关注用户的服务需求描述与组合Web服务中首尾位置的服务描述的相似度，相似度计算分为语义相似度计算和语法相似度计算。



服务描述的语义相似度计算方法和参数相似度计算方法类似，其计算公式如下

![image-20210915220917371](image-20210915220917371.png)

服务描述的语法相似度，采用余弦相似度计算方法，分别计算两个词组中每个词语的出现频次，得到词频向量$ActionDescVec = \{x_1, x_2, ... x_t\}$ 和 $ServiceDescVec = \{y_1, y_2, ... y_t\}$，最终服务描述的语法相似度计算公式如下



![image-20210915224826261](image-20210915224826261.png)

![image-20210915224811286](image-20210915224811286.png)

**Q7：**

如何筛选组合服务

**A7：**

在获取了组合服务路径的集合后，计算每路径对业务需求的匹配程度，其中计算公式基于三部分

* 组合服务中第一个服务的输入参数集与用户的输入参数集的相似度
* 组合服务中最后一个服务的输出参数集与用户的输出参数集的相似度
* 组合服务中首尾位置服务的描述与用户的服务需求描述的相似度

![image-20210915232550890](image-20210915232550890.png)





#### 4. 组合服务的筛选







### 系统实现



### 结论与展望

